(function($){
	
	var initComponent = function(){
		$(".modal").on("shown.bs.modal",function(){
			$(this).find("form :input:not(:disabled):not(:hidden)").first().focus();
		});
		
		$(".btn").button();
		
		$("form[valid!='false']").each(function(i,o){
			var temp = $(o);
			
			temp.find(":input:not(:disabled):not(:hidden)").first().focus();
			
			temp.validate({
				submitHandler : function(form) {
					form.submit();
				}
			});
			
			temp.find("button[type='reset']").click(function(){
				
				temp.find("input:not(:disabled):not(:hidden)").each(function(i,field){
					$(field).val("");
				});
				
				temp.find("select:not(:disabled):not(:hidden)").each(function(i,field){
					$(field).val("");
				});
				
				return false;
			});
			
		});
	};

	$.validator.setDefaults({
		showErrors : function(errorMap, errorList) {
			$.each(this.successList,function(i,e){
				var element = $(e);
				element.parent("div").removeClass("has-error");
				element.tooltip("destroy");
			});
			
			$.each(errorList, function(i, e) {
				var element = $(e.element);
				var tip = element.data('bs.tooltip');
				if ($.isNotEmpty(tip)) {
					tip.options.title = e.message;
					element.next().children(".tooltip-inner").html(e.message);
				} else {
					element.parent("div").addClass("has-error");
					element.tooltip({
						title:e.message,
						trigger:"focus"
					});
				}
			});
		}
	});
	
	$(document).ready(initComponent);
	
})(jQuery);
